@mixin responsiveTable {
  .dnb-table {
    &--responsive thead * {
      @include allBelow(small) {
        // @include srOnly();
        pointer-events: none;
        user-select: none;
      }
    }

    &__main_cell {
      display: flex;
      align-items: center;

      // @include allBelow(small) {
      //   background-color: var(--color-white);
      // }

      &__inner {
        display: flex;
        align-items: center;

        &__wrapper {
          display: flex;
          flex-direction: column;

          margin-right: 1rem;
        }
      }

      &__title.dnb-p {
        @include allAbove(small) {
          white-space: nowrap;
        }
      }
      &__info.dnb-p {
        margin-top: 0.25rem;

        font-size: var(--font-size-x-small);
        color: var(--color-black-55);
      }
      &__avatar {
        margin-right: 1rem;
      }
    }

    &__main_cell &__toggle-button,
    td:nth-of-type(2) &__toggle-button {
      .dnb-button__bounding {
        transform: scale(3);
      }
    }
    &__toggle-button .dnb-button__icon {
      transition: transform 800ms var(--accordion-easing);
    }

    // Do not change the behavior of the button
    // @include allBelow(small) {
    //   &__toggle-button .dnb-button__icon {
    //     transform: rotate(90deg);
    //   }
    //   &__tr--open &__toggle-button .dnb-button__icon {
    //     transform: rotate(270deg);
    //   }
    // }

    @include allBelow(small) {
      td:nth-of-type(2) {
        display: flex;
        align-items: center;
      }
      td:not(.dnb-table__main_cell) &__toggle-button {
        margin-right: 1.5rem;
      }

      // POC: If we would use TableToggleButton inside second td
      // td.dnb-table__main_cell &__toggle-button {
      //   display: none;
      // }
    }
    @include allAbove(small) {
      td:not(.dnb-table__main_cell) &__toggle-button {
        display: none;
      }
    }

    &__tr {
      // Is required in order to calculate the "offsetTop"
      position: relative;
    }

    &__td {
      &__children {
        order: 1;
      }
      &__info {
        order: 2;
      }
      &__info.dnb-p {
        font-size: var(--font-size-x-small);
        color: var(--color-black-55);

        @include allAbove(small) {
          display: none;
        }
      }
    }

    @include allBelow(small) {
      &--responsive tbody &__tr {
        cursor: pointer;

        display: flex;
        flex-wrap: wrap;

        &:not(.dnb-table__tr--has-accordion-content):not(.dnb-table__tr__accordion_content) {
          overflow: hidden;
          max-height: var(--tr-height--closed, 10rem);
        }
        &--open:not(.dnb-table__tr--has-accordion-content):not(.dnb-table__tr__accordion_content) {
          max-height: var(--tr-height--open, 50rem);

          background-color: var(--color-pistachio);
        }
        &--open:not(#{&}--no-animation),
        &--closed:not(#{&}--no-animation) {
          transition: max-height 800ms var(--accordion-easing),
            background-color 800ms var(--accordion-easing);

          html[data-visual-test] & {
            transition-duration: 1ms !important;
          }
        }

        .dnb-table__main_cell {
          display: flex;
          justify-content: space-between;
          width: 100%;

          &__title,
          &__info {
            overflow: hidden;
            text-overflow: ellipsis;

            // Webkit (Chromium and Safari)
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;

            // Firefox
            display: -moz-box; // stylelint-disable-line
            -moz-line-clamp: 1;
            -moz-box-orient: vertical;
          }
        }

        td:not(.dnb-table__main_cell) {
          @include allBelow(small) {
            padding-top: 0;
          }
        }
        td:not(.dnb-table__main_cell) &__vertical {
          display: flex;
          flex-direction: column;

          align-items: flex-start;
          justify-content: flex-end;
        }
      }
    }

    @include allBelow(small) {
      position: relative;

      > tbody .dnb-table__tr::before,
      > tbody .dnb-table__tr::after {
        pointer-events: none;
        content: '';

        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        width: 100%;
      }
      > tbody .dnb-table__tr:not(:last-of-type)::after {
        content: none;
      }
      > tbody .dnb-table__tr:last-of-type::after {
        top: auto;
        bottom: 0;
      }

      &__variant--cards
        > tbody
        &__tr:not(.dnb-table__tr__accordion_content) {
        &:not(:first-of-type) {
          margin-top: 0.5rem;
        }

        &::before {
          z-index: 2;
          bottom: 0;

          border: 1px solid var(--color-black-20);
          border-radius: 0.5rem;
          transition: border-radius 600ms var(--accordion-easing);

          background-color: transparent;
        }
      }
    }
  }
}

@mixin responsiveTableTheme {
  .dnb-table {
    @include allBelow(small) {
      &--responsive &__tr:not(#{&}__tr--odd):nth-of-type(2n),
      &--responsive &__tr--even {
        background-color: var(--color-white);
      }

      &__variant--cards > thead > &__tr:last-of-type::after,
      &__variant--cards > tbody > &__tr:last-of-type::after {
        background-color: transparent;
      }

      &__variant--lines > tbody &__tr::before,
      // &__variant--lines > tbody &__tr::after,// is this needed?
      &__variant--lines > tbody &__tr:last-of-type::after {
        height: 1px;
        background-color: var(--color-black-20);
      }
    }
  }
}
